{"mappings":"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","sources":["src/js/verification.js"],"sourcesContent":["import { TezosToolkit } from \"@taquito/taquito\";\nimport { BeaconWallet } from \"@taquito/beacon-wallet\";\nimport { TezosOperationType } from \"@airgap/beacon-sdk\";\n\nconst Tezos = new TezosToolkit(rpc_addr);\nconst Wallet = new BeaconWallet({ name: \"Tezos Haiku\" });\nTezos.setWalletProvider(Wallet);\n\nTezos.contract.at(contract_addr)\n  .then(contract => {\n    return contract.storage()\n      .then(storage => {\n        assign_data(storage)\n        check_wallet()\n      })\n  })\n  .catch(error => console.log(`Error: ${JSON.stringify(error, null, 2)}`));\n\ncheck_wallet = async () => {\n  const activeAccount = await Wallet.client.getActiveAccount();\n  if (!activeAccount) {\n    document.getElementById('buttons_preview').innerHTML += '<a class=\"btn btn_secondary right_down_space\" onclick=\"connect_wallet()\">Connect wallet</a>'\n  } else {\n    user_addr = activeAccount.address;\n  }\n  data_loaded = true\n  main_start()\n}\n\nconnect_wallet = async () => {\n  const activeAccount = await Wallet.client.getActiveAccount();\n  if (!activeAccount) {\n    const permissions = await Wallet.client.requestPermissions({\n      network: {\n        type: network,\n        rpcUrl: rpc_addr,\n      },\n    });\n    user_addr = permissions.address;\n  } else {\n    user_addr = activeAccount.address;\n  }\n\n  document.getElementById('buttons_preview').lastChild.remove()\n  data_loaded = true\n  main_start()\n}\n\ndisconnect_wallet = async () => await Wallet.clearActiveAccount()\n\nconst assign_data = (storage) => {\n  data.tokens = []\n  data.owners = []\n  data.reports = []\n\n  for (const [key, value] of storage.token.valueMap) {\n    value.id = Number(key.slice(1, -1))\n    value.amount = Number(value.amount)\n    value.state = Number(value.state)\n    value.cnfrm_at = new Date(value.cnfrm_at)\n    value.crted_at = new Date(value.crted_at)\n    value.text_color = Number(value.text_color)\n    const c_t = { b: value.text_color % 256 }\n    c_t.g = (value.text_color - c_t.b) / 256 % 256\n    c_t.r = ((value.text_color - c_t.b) / 256 - c_t.g) / 256 % 256\n    value.back_color = Number(value.back_color)\n    const c_b = { b: value.back_color % 256 }\n    c_b.g = (value.back_color - c_b.b) / 256 % 256\n    c_b.r = ((value.back_color - c_b.b) / 256 - c_b.g) / 256 % 256\n    value.image = `<svg class=\"\" width=\"338px\" height=\"225px\" role=\"img\" focusable=\"false\">\n    <rect width=\"100%\" height=\"100%\" fill=\"rgb(${c_b.r},${c_b.g},${c_b.b})\" rx=\"0.25rem\" ry=\"0.25rem\"></rect>\n    <text y=\"20%\" fill=\"white\" font-size=\"1.2em\">\n      ${value.content.split('\\n').reduce((a, c) => a + `<tspan x=\"10%\" dy=\"1.6em\" fill=\"rgb(${c_t.r},${c_t.g},${c_t.b})\">${c}</tspan>`, \"\")}\n    </text>\n  </svg>`\n    data.tokens.push(value)\n  }\n  for (const [s_key, value] of storage.ledger.valueMap) {\n    const key = JSON.parse(s_key)\n    value.token_id = Number(key[1])\n    value.owner = key[0]\n    value.count = Number(value.count)\n    value.for_sale = Number(value.for_sale)\n    value.price = Number(value.price)\n    data.owners.push(value)\n  }\n  for (const [key, value] of storage.report.valueMap) {\n    value.id = Number(key.slice(1, -1))\n    value.rep_t_id = Number(value.rep_t_id)\n    data.reports.push(value)\n  }\n}\n\nconst eq_words = (s1, s2) => {\n  const s1_words = s1.toLowerCase().replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\")\n    .split('\\n').join(' ').split(' ').filter(c => c.length > 3).reduce((a, c) => { if (a.indexOf(c) == -1) a.push(c); return a }, [])\n  const s2_words = s2.toLowerCase().replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\")\n    .split('\\n').join(' ').split(' ').filter(c => c.length > 3).reduce((a, c) => { if (a.indexOf(c) == -1) a.push(c); return a }, [])\n  return s1_words.reduce((a, c) => a + s2_words.includes(c), 0)\n}\n\nconst main_start = () => {\n  if (!dom_loaded || !data_loaded) return\n\n  console.log(data.tokens)\n  console.log(data.owners)\n  console.log(data.reports)\n\n  document.getElementById(\"tokens\").innerHTML = ''\n\n  for (const t of data.tokens.filter(c => c.state == 0).sort((a, b) => a.crted_at - b.crted_at)) {\n    const rep = data.reports.filter(c => c.rep_t_id == t.id)\n\n    let nearest = ''\n    for (const n of data.tokens.filter(c => t.crted_at > c.crted_at)) {\n      if (!nearest || eq_words(nearest, t.content) < eq_words(n.content, t.content)) nearest = n.content\n    }\n    const eq_counter = eq_words(nearest, t.content)\n\n    document.getElementById(\"tokens\").innerHTML += `<div class=\"card token\">\n      ${t.image}\n      <div class=\"card-body\">\n        <p class=\"card-text\" style=\"margin-bottom: 0;\">Haiku #${t.id} written by <a style=\"font-family:monospace; font-size: initial;\">${t.creator}</a></p>\n      </div>\n      ${t.cnfrm_by.length + t.rejct_by.length >= min_voted_users &&\n        Number(t.cnfrm_at) + min_voted_time * 1000 <= Number(new Date()) &&\n        (rep.reduce((a, c) => a || (c.yes_by.length + c.no_by.length >= min_voted_on_report && c.yes_by.length / (c.yes_by.length + c.no_by.length) >= voted_positive_percent), rep.length == 0)\n          || rep.reduce((a, c) => a && (c.yes_by.length + c.no_by.length >= min_voted_on_report), true)) ? `\n        <div class=\"card-body\">\n          <div class=\"d-flex justify-content-between align-items-center\">\n            <button type=\"button\" id=\"update_button-${t.id}\" class=\"btn btn-sm btn-outline-secondary verify_button\">VERIFY</button>\n          </div>\n          <p class=\"buy_note\" id=\"note_result-${t.id}\">${!user_addr ? 'Please, connect your wallet to vote for haikus' : ''}</p>\n        </div>` : `\n        ${nearest && eq_counter >= 3 ? `<div class=\"card-body plagiarism\"><p style=\"margin-bottom:5px;\">Possible plagiarism of:</p><p style=\"margin-bottom:0;\">${nearest.split('\\n').join('<br>')}</p></div>` : ''}\n      <div class=\"card-body\">\n        <div class=\"voting\">\n          <button type=\"button\" class=\"btn btn_voting_good\" id=\"good_vote-${t.id}\" ${t.cnfrm_by.includes(user_addr) || !user_addr ? 'disabled' : ''}></button>\n          <div class=\"progress\" style=\"width: 100%;margin: 5px;\">\n            <div class=\"progress-bar\" role=\"progressbar\" id=\"voting_bar-${t.id}\" style=\"width: ${t.cnfrm_by.length + t.rejct_by.length ? t.cnfrm_by.length / (t.cnfrm_by.length + t.rejct_by.length) * 100 : 50}%\"></div>\n          </div>\n          <button type=\"button\" class=\"btn btn_voting_bad\" id=\"bad_vote-${t.id}\" ${t.rejct_by.includes(user_addr) || !user_addr ? 'disabled' : ''}></button>\n        </div>\n        <p class=\"buy_note\" id=\"note_vote-${t.id}\">Total number of votes: ${t.cnfrm_by.length + t.rejct_by.length}. You have${t.cnfrm_by.includes(user_addr) ? ' voted for green' : t.rejct_by.includes(user_addr) ? ' voted for red' : \"n't voted\"}</p>\n        <p></p>\n        <div class=\"d-flex justify-content-between align-items-center\">\n          ${Number(t.cnfrm_at) + min_voted_time * 1000 <= Number(new Date()) ? '<p></p>' : `<button type=\"button\" id=\"report_button-${t.id}\" class=\"btn btn-sm btn-outline-secondary buy_button\">Report</button>`}\n          <small class=\"text-muted\">${t.crted_at.toGMTString().split(', ')[1].slice(0, -7)}</small>\n        </div>\n        <p class=\"buy_note\" id=\"note_result-${t.id}\">${!user_addr ? 'Please, connect your wallet to vote for haikus' : ''}</p>\n      </div>\n      ${rep.reduce((a, c) => a + `<div class=\"card-body viol_cprt\">\n        <p class=\"card-text\">Possible violation of copyright!</p>\n        <p class=\"card-text\">This is known haiku of <a style=\"font-family:monospace; font-size: initial;\">${c.orig_author}</a></p>\n        <p class=\"card-text\">Prove link: <a href=\"${c.orig_link}\">proves here</a></p>\n        <div class=\"voting\">\n          <button type=\"button\" class=\"btn btn_voting_good\" id=\"rep_good_vote-${c.id}\" ${c.yes_by.includes(user_addr) || !user_addr ? 'disabled' : ''}></button>\n          <div class=\"progress\" style=\"width: 100%;margin: 5px;\">\n            <div class=\"progress-bar\" role=\"progressbar\" id=\"rep_voting_bar-${c.id}\" style=\"width: ${c.yes_by.length + c.no_by.length ? c.yes_by.length / (c.yes_by.length + c.no_by.length) * 100 : 50}%\"></div>\n          </div>\n          <button type=\"button\" class=\"btn btn_voting_bad\" id=\"rep_bad_vote-${c.id}\" ${c.no_by.includes(user_addr) || !user_addr ? 'disabled' : ''}></button>\n        </div>\n        <p class=\"buy_note\" id=\"rep_note_vote-${c.id}\">Total number of votes: ${c.yes_by.length + c.no_by.length}. You have${c.yes_by.includes(user_addr) ? ' voted for green' : c.no_by.includes(user_addr) ? ' voted for red' : \"n't voted\"}</p>\n        <p class=\"buy_note\" id=\"rep_note_result-${c.id}\">${!user_addr ? 'Please, connect your wallet to vote for haikus' : ''}</p>\n      </div>`, '')}`}\n    </div>`\n  }\n}\n\nreport_open = async (id) => {\n  const t = data.tokens[id]\n  const rep = data.reports.filter(c => c.rep_t_id == id)\n  document.getElementById('report_popup').innerHTML = `<section id=\"report_popup_overlay\" class=\"overlay__\">\n    <div class=\"container__\">\n      <h1 class=\"fw-light buy_header\">Report on Haiku #${t.id}</h1>\n      <div class=\"card token buy_image\">\n        ${t.image}\n      </div>\n      <div class=\"buy_body\">\n        <div class=\"buy_inputs\">\n          <label for=\"real_author\" class=\"buy_label\">Please enter name of real author of this haiku</label>\n          <input type=\"text\" class=\"form_range\" id=\"real_author\">\n          <label for=\"real_link\" class=\"buy_label\">Please past a prove link here</label>\n          <input type=\"text\" class=\"form_range\" id=\"real_link\">\n        </div>\n        <div class=\"btn-group buy_btn_group\" role=\"group\">\n          <button type=\"button\" onclick=\"report_close()\" class=\"btn btn_secondary buy_cfrm_button\">CANCEL</button>\n          ${user_addr && rep.filter(c => c.reporter_adrs == user_addr).length == 0 ? `<button type=\"button\" id=\"report_cfrm-${id}\" class=\"btn btn_primary buy_cfrm_button\">REPORT</button>` : `<button type=\"button\" id=\"report_cfrm-${id}\" class=\"btn btn_primary buy_cfrm_button\" disabled>REPORT</button>`}\n        </div>\n        <p class=\"buy_note\" id=\"note_result\">${!user_addr ? 'Please, connect your wallet to report on haikus' : rep.filter(c => c.reporter_adrs == user_addr).length > 0 ? 'You have already sent report on this haiku' : ''}</p>\n      </div>\n    </div>\n  </section>`\n}\nreport_close = () => {\n  document.getElementById('report_popup').innerHTML = ''\n}\n\nconst token_vote_for_state = async (id, state) => {\n  let t = data.tokens[id]\n\n  document.getElementById(`bad_vote-${id}`).disabled = true\n  document.getElementById(`good_vote-${id}`).disabled = true\n  document.getElementById(`note_result-${t.id}`).innerHTML = 'Please, confirm transaction in your wallet'\n  contract = contract ? contract : await Tezos.wallet.at(contract_addr);\n  try {\n    const result = await contract.methods.token_vote_for_state(Number(id), votes.indexOf(state)).send();\n    document.getElementById(`note_result-${t.id}`).innerHTML = 'Your request is in work. Wait some and update page to view changes.'\n  } catch (error) {\n    if (error.title == 'Aborted') {\n      document.getElementById(`note_result-${t.id}`).innerHTML = 'Please, try again and confirm transaction in your wallet'\n      document.getElementById(`bad_vote-${id}`).disabled = t.rejct_by.includes(user_addr)\n      document.getElementById(`good_vote-${id}`).disabled = t.cnfrm_by.includes(user_addr)\n    } else {\n      document.getElementById(`note_result-${t.id}`).innerHTML = 'Something went wrong, please update page and try again'\n    }\n    console.log(`The contract call failed and the following error was returned:`, error);\n    return\n  }\n  if (state == \"yes\") {\n    t.cnfrm_by.push(user_addr)\n    if (t.rejct_by.includes(user_addr))\n      t.rejct_by.splice(t.rejct_by.indexOf(user_addr), 1)\n    document.getElementById(`note_vote-${id}`).innerHTML = `Total number of votes: ${t.cnfrm_by.length + t.rejct_by.length}. You have voted for green`\n  }\n  if (state == \"no\") {\n    t.rejct_by.push(user_addr)\n    if (t.cnfrm_by.includes(user_addr))\n      t.cnfrm_by.splice(t.cnfrm_by.indexOf(user_addr), 1)\n    document.getElementById(`note_vote-${id}`).innerHTML = `Total number of votes: ${t.cnfrm_by.length + t.rejct_by.length}. You have voted for red`\n  }\n  document.getElementById(`voting_bar-${id}`).style.width = `${t.cnfrm_by.length / (t.cnfrm_by.length + t.rejct_by.length) * 100}%`\n}\nconst token_vote_for_report = async (id, state) => {\n  let t = data.reports[id]\n\n  document.getElementById(`rep_bad_vote-${id}`).disabled = true\n  document.getElementById(`rep_good_vote-${id}`).disabled = true\n  document.getElementById(`rep_note_result-${t.id}`).innerHTML = 'Please, confirm transaction in your wallet'\n  contract = contract ? contract : await Tezos.wallet.at(contract_addr);\n  try {\n    const result = await contract.methods.token_vote_for_report(Number(id), votes.indexOf(state)).send();\n    document.getElementById(`rep_note_result-${t.id}`).innerHTML = 'Your request is in work. Wait some and update page to view changes.'\n  } catch (error) {\n    if (error.title == 'Aborted') {\n      document.getElementById(`rep_note_result-${t.id}`).innerHTML = 'Please, try again and confirm transaction in your wallet'\n      document.getElementById(`rep_bad_vote-${id}`).disabled = t.no_by.includes(user_addr)\n      document.getElementById(`rep_good_vote-${id}`).disabled = t.yes_by.includes(user_addr)\n    } else {\n      document.getElementById(`rep_note_result-${t.id}`).innerHTML = 'Something went wrong, please update page and try again'\n    }\n    console.log(`The contract call failed and the following error was returned:`, error);\n    return\n  }\n  if (state == \"yes\") {\n    t.yes_by.push(user_addr)\n    if (t.no_by.includes(user_addr))\n      t.no_by.splice(t.no_by.indexOf(user_addr), 1)\n    document.getElementById(`rep_note_vote-${id}`).innerHTML = `Total number of votes: ${t.yes_by.length + t.no_by.length}. You have voted for green`\n  }\n  if (state == \"no\") {\n    t.no_by.push(user_addr)\n    if (t.yes_by.includes(user_addr))\n      t.yes_by.splice(t.yes_by.indexOf(user_addr), 1)\n    document.getElementById(`rep_note_vote-${id}`).innerHTML = `Total number of votes: ${t.yes_by.length + t.no_by.length}. You have voted for red`\n  }\n  document.getElementById(`rep_voting_bar-${id}`).style.width = `${t.yes_by.length / (t.yes_by.length + t.no_by.length) * 100}%`\n}\nconst token_report = async (id, state) => {\n  document.getElementById(`report_cfrm-${id}`).disabled = true\n  document.getElementById('note_result').innerHTML = 'Please, confirm transaction in your wallet'\n  contract = contract ? contract : await Tezos.wallet.at(contract_addr);\n  try {\n    const result = await contract.methods.token_report(Number(id), document.getElementById('real_author').value, document.getElementById('real_link').value).send();\n    document.getElementById(`note_result`).innerHTML = 'Your request is in work. Wait some and update page to view changes.'\n  } catch (error) {\n    if (error.title == 'Aborted') {\n      document.getElementById(`note_result`).innerHTML = 'Please, try again and confirm transaction in your wallet'\n      document.getElementById(`report_cfrm-${id}`).disabled = false\n    } else {\n      document.getElementById(`note_result`).innerHTML = 'Something went wrong, please update page and try again'\n    }\n    console.log(`The contract call failed and the following error was returned:`, error);\n  }\n}\nconst token_update_state = async (id, state) => {\n  document.getElementById(`update_button-${id}`).disabled = true\n  document.getElementById(`note_result-${id}`).innerHTML = 'Please, confirm transaction in your wallet'\n  contract = contract ? contract : await Tezos.wallet.at(contract_addr);\n  try {\n    const result = await contract.methods.token_update_state(Number(id)).send();\n    document.getElementById(`note_result-${id}`).innerHTML = 'Your request is in work. Wait some and update page to view changes.'\n  } catch (error) {\n    if (error.title == 'Aborted') {\n      document.getElementById(`note_result-${id}`).innerHTML = 'Please, try again and confirm transaction in your wallet'\n      document.getElementById(`update_button-${id}`).disabled = false\n    } else {\n      document.getElementById(`note_result-${id}`).innerHTML = 'Something went wrong, please update page and try again'\n    }\n    console.log(`The contract call failed and the following error was returned:`, error);\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => { dom_loaded = true; main_start() })\ndocument.addEventListener('click', e => {\n  if (e.target.id == 'report_popup_overlay') report_close()\n  const id = e.target.id.split('-')\n  if (id[0] == 'good_vote') {\n    token_vote_for_state(id[1], \"yes\")\n  }\n  if (id[0] == 'bad_vote') {\n    token_vote_for_state(id[1], \"no\")\n  }\n  if (id[0] == 'rep_good_vote') {\n    token_vote_for_report(id[1], \"yes\")\n  }\n  if (id[0] == 'rep_bad_vote') {\n    token_vote_for_report(id[1], \"no\")\n  }\n  if (id[0] == 'report_button') {\n    report_open(id[1])\n  }\n  if (id[0] == 'report_cfrm') {\n    token_report(id[1])\n  }\n  if (id[0] == 'update_button') {\n    token_update_state(id[1])\n  }\n})\ndocument.addEventListener('input', e => {\n  if (e.target.id == 'real_author') {\n    document.getElementById('real_author').value = e.target.value.slice(0, max_max_report_author)\n  }\n  if (e.target.id == 'real_link') {\n    document.getElementById('real_link').value = e.target.value.slice(0, max_max_report_url)\n  }\n})\n"],"names":["_taquito","require","_beaconWallet","Tezos","TezosToolkit","rpc_addr","Wallet","BeaconWallet","name","setWalletProvider","contract","at","contract_addr","then","storage","assign_data","check_wallet","catch","error","console","log","JSON","stringify","async","activeAccount","client","getActiveAccount","user_addr","address","document","getElementById","innerHTML","data_loaded","main_start","connect_wallet","permissions","requestPermissions","network","type","rpcUrl","lastChild","remove","disconnect_wallet","clearActiveAccount","data","tokens","owners","reports","key","value","token","valueMap","id","Number","slice","amount","state","cnfrm_at","Date","crted_at","text_color","c_t","b","g","r","back_color","c_b","image","content","split","reduce","a","c","push","s_key","value1","ledger","key1","parse","token_id","owner","count","for_sale","price","value2","report","rep_t_id","eq_words","s1","s2","s1_words","toLowerCase","replace","join","filter","length","indexOf","s2_words","includes","dom_loaded","t","sort","rep","nearest","n","eq_counter","creator","cnfrm_by","rejct_by","min_voted_users","min_voted_time","yes_by","no_by","min_voted_on_report","voted_positive_percent","toGMTString","orig_author","orig_link","report_open","reporter_adrs","report_close","token_vote_for_state","disabled","wallet","methods","votes","send","title","splice","style","width","token_vote_for_report","addEventListener","e","target","token_report","token_update_state","max_max_report_author","max_max_report_url"],"version":3,"file":"verification.b0aa705f.js.map"}